# 自动化警信人员预警系统

这是一个基于DrissionPage的自动化系统，用于处理重点人网站的情报信息并自动发送到警信群聊。

## 功能特性

- 🔄 自动登录重点人网站和警信网站
- 📊 定时检查新的情报信息
- 📁 自动下载相关文件
- 📤 自动上传文件到警信群聊
- 🖥️ 直观的GUI界面
- 📝 详细的日志记录
- ⚙️ 三种运行模式：新浏览器、连接已有浏览器、无头模式

## 系统要求

- Windows 操作系统
- Python 3.6+
- Chrome或Edge浏览器

## 安装步骤

1. 安装依赖包：
```bash
pip install -r requirements.txt
```

2. 运行程序：
```bash
python main.py
```

## 使用说明

### 配置系统

1. **重点人网站配置**：
   - 账号1用户名：输入重点人网站第一个账号的用户名（必填）
   - 账号1密码：输入重点人网站第一个账号的密码（必填）
   - 账号2用户名：输入重点人网站第二个账号的用户名（可选）
   - 账号2密码：输入重点人网站第二个账号的密码（可选）

2. **警信网站配置**：
   - 身份证号：输入警信网站的登录身份证号
   - 密码：输入警信网站的登录密码
   - 群聊名称：默认为"情指值班通知"，可自定义

3. **运行模式**：
   - 新浏览器：每次启动新的浏览器实例
   - 连接已有浏览器：连接已经打开的浏览器
   - 无头模式：后台运行，不显示浏览器界面

4. **循环间隔**：设置自动执行的间隔时间（分钟）

### 操作步骤

1. 配置所有必要信息
2. 点击"保存配置"
3. 点击"开始运行"启动自动化系统
4. 系统将每隔设定时间自动执行一次完整流程
5. 可以点击"立即执行一次"进行手动测试
6. 在运行日志中查看详细的执行信息

## 工作流程

1. **重点人网站处理**：
   - 使用账号1登录重点人网站
   - 导航到"我的情报"→"未接收"
   - 检查当天的新情报信息并下载相关文件
   - 如果配置了账号2，则重复上述流程

2. **警信网站处理**：
   - 登录警信网站
   - 进入指定群聊
   - 上传下载的文件

3. **循环执行**：
   - 每次执行后等待指定时间
   - 自动重复上述流程

## 文件结构

```
├── main.py              # 主程序入口
├── gui.py               # GUI界面
├── website_handler.py   # 网站操作处理器
├── config.py           # 配置管理
├── logger.py           # 日志系统
├── requirements.txt    # 依赖包列表
├── config.json         # 配置文件（自动生成）
├── logs/               # 日志目录
└── downloads/          # 下载文件目录
```

## 注意事项

1. 请确保网络连接稳定
2. 首次运行时需要配置所有登录信息
3. 建议定期检查日志文件
4. 如遇到问题，可查看日志文件获取详细错误信息

## 打包发布

使用pyinstaller打包为单个可执行文件：

```bash
# 安装pyinstaller（如果尚未安装）
pip install pyinstaller

# 打包为单个exe文件
pyinstaller -w --onefile main.py

# 打包完成后，可执行文件位于dist目录下
```

**注意**：打包后的exe文件可以独立运行，无需Python环境。

## 技术支持

如有问题请查看运行日志或联系开发人员。 